<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Simple IP API data parser demo that shows location information retrieved from ipapi.co.">
    <meta name="theme-color" content="#ffffff">
    <meta name="color-scheme" content="light dark">
    <link rel="canonical" href="https://inputdrivesecurity.us/parsing_api.html">
    <title>IP API Data Parser</title>
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="preconnect" href="https://ipapi.co" />
</head>
<body>
    <header style="background:#fff;border-bottom:1px solid #e6e6e6;padding:12px 16px;">
        <div style="max-width:900px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;">
            <strong>Input Drive Security</strong>
            <nav><a href="/index.html">Index</a></nav>
        </div>
    </header>

    <main style="max-width:900px;margin:28px auto;padding:0 16px;">
        <h1>IP API Data Parser</h1>
        <p style="font-size:0.9rem;color:#666;">Loading location information...</p>
        <div id="data" style="background:#f5f5f5;padding:16px;border-radius:4px;margin:16px 0;"></div>
    <script>
        let apiSuccess = false;
        
        function displayData(data) {
            let output = "<h2>Your Location Information</h2>";
            output += "<table style='width:100%;border-collapse:collapse;'>";
            output += "<tr><td style='padding:8px;border-bottom:1px solid #ddd;'><strong>IP Address:</strong></td><td style='padding:8px;border-bottom:1px solid #ddd;'>" + (data.ip || "N/A") + "</td></tr>";
            output += "<tr><td style='padding:8px;border-bottom:1px solid #ddd;'><strong>City:</strong></td><td style='padding:8px;border-bottom:1px solid #ddd;'>" + (data.city || "N/A") + "</td></tr>";
            output += "<tr><td style='padding:8px;border-bottom:1px solid #ddd;'><strong>Region:</strong></td><td style='padding:8px;border-bottom:1px solid #ddd;'>" + (data.region || "N/A") + "</td></tr>";
            output += "<tr><td style='padding:8px;border-bottom:1px solid #ddd;'><strong>Country:</strong></td><td style='padding:8px;border-bottom:1px solid #ddd;'>" + (data.country_name || "N/A") + "</td></tr>";
            output += "<tr><td style='padding:8px;border-bottom:1px solid #ddd;'><strong>Latitude:</strong></td><td style='padding:8px;border-bottom:1px solid #ddd;'>" + (data.latitude || "N/A") + "</td></tr>";
            output += "<tr><td style='padding:8px;border-bottom:1px solid #ddd;'><strong>Longitude:</strong></td><td style='padding:8px;border-bottom:1px solid #ddd;'>" + (data.longitude || "N/A") + "</td></tr>";
            output += "<tr><td style='padding:8px;border-bottom:1px solid #ddd;'><strong>Timezone:</strong></td><td style='padding:8px;border-bottom:1px solid #ddd;'>" + (data.timezone || "N/A") + "</td></tr>";
            output += "<tr><td style='padding:8px;'><strong>ISP:</strong></td><td style='padding:8px;'>" + (data.org || "N/A") + "</td></tr>";
            output += "</table>";
            document.getElementById("data").innerHTML = output;
        }
        
        function showError() {
            document.getElementById("data").innerHTML = "<p style='color:#dc3545;'><strong>⚠️ Error:</strong> Unable to fetch IP information from all available services. This could be due to:</p>" +
                "<ul style='text-align:left;margin:12px 0;'>" +
                "<li>Ad blocker or privacy extension blocking geolocation services</li>" +
                "<li>VPN or proxy blocking API access</li>" +
                "<li>Network connectivity issue</li>" +
                "<li>Browser privacy settings restricting cross-origin requests</li>" +
                "</ul>" +
                "<p style='font-size:0.9rem;color:#666;'>Try disabling ad blockers or privacy extensions and refreshing the page.</p>";
        }
        
        function tryApi(url, successCallback, errorCallback) {
            fetch(url, { mode: 'cors' })
                .then(response => {
                    if (!response.ok) throw new Error('API error');
                    return response.json();
                })
                .then(data => {
                    apiSuccess = true;
                    successCallback(data);
                })
                .catch(error => errorCallback());
        }
        
        // Try primary API: ipapi.co
        tryApi(
            "https://ipapi.co/json/",
            displayData,
            function() {
                // Fallback to secondary API: ip-api.com
                tryApi(
                    "https://ip-api.com/json/",
                    function(data) {
                        var mappedData = {
                            ip: data.query,
                            city: data.city,
                            region: data.region,
                            country_name: data.country,
                            latitude: data.lat,
                            longitude: data.lon,
                            timezone: data.timezone,
                            org: data.isp
                        };
                        displayData(mappedData);
                    },
                    function() {
                        // Final fallback: ipwho.is
                        tryApi(
                            "https://ipwho.is/",
                            function(data) {
                                var mappedData = {
                                    ip: data.ip,
                                    city: data.city,
                                    region: data.region,
                                    country_name: data.country_name,
                                    latitude: data.latitude,
                                    longitude: data.longitude,
                                    timezone: data.timezone,
                                    org: data.connection ? data.connection.isp : "Unknown"
                                };
                                displayData(mappedData);
                            },
                            showError
                        );
                    }
                );
            }
        );
    </script>
    <p id="lastModified"></p>
    <script>
        const lastModified = new Date(document.lastModified);
        document.getElementById("lastModified").innerHTML = "Page last edited: " + lastModified;
    </script>
    <p><a href="/index.html">Back to Index</a></p>
    </main>

    <footer style="border-top:1px solid #eee;padding:14px 0;text-align:center;color:#666;margin-top:28px;">
        <div style="max-width:900px;margin:0 auto;">© 2025 Input Drive Security</div>
    </footer>
</body>
</html>